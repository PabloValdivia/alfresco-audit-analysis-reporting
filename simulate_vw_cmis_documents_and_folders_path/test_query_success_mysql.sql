select `stg_cmis_document`.`cmis_objectid` AS `cmis_objectid`,`stg_cmis_document`.`cmis_objecttypeid` AS `cmis_objecttypeid`,concat(ucase(`stg_cmis_folder`.`cmis_path`) , (case when (`stg_cmis_folder`.`cmis_path` <> '/') then '/' else '' end) , ucase(`stg_cmis_document`.`cmis_name`)) AS `cmis_path` from ((`stg_cmis_documents` `stg_cmis_document` join `ope_cmis_document_parent`) join `stg_cmis_folders` `stg_cmis_folder`) where ((`stg_cmis_document`.`alfresco_id` = `ope_cmis_document_parent`.`alfresco_id`) and (`ope_cmis_document_parent`.`cmis_objectid` = `stg_cmis_document`.`cmis_objectid`) and (`ope_cmis_document_parent`.`alfresco_id` = `stg_cmis_folder`.`alfresco_id`) and (`ope_cmis_document_parent`.`cmis_parentid` = `stg_cmis_folder`.`cmis_objectid`)) union all select `stg_cmis_folder`.`cmis_objectid` AS `cmis_objectid`,`stg_cmis_folder`.`cmis_objecttypeid` AS `cmis_objecttypeid`,ucase(`stg_cmis_folder`.`cmis_path`) AS `cmis_path` from `stg_cmis_folders` `stg_cmis_folder` where (`stg_cmis_folder`.`cmis_path` is not null);

show warnings;