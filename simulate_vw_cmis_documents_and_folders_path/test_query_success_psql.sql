SELECT stg_cmis_document.cmis_objectid, stg_cmis_document.cmis_objecttypeid, ((upper((stg_cmis_folder.cmis_path)::text) || CASE WHEN ((stg_cmis_folder.cmis_path)::text <> '/'::text) THEN '/'::text ELSE ''::text END) || upper((stg_cmis_document.cmis_name)::text)) AS cmis_path FROM stg_cmis_documents stg_cmis_document, ope_cmis_document_parent, stg_cmis_folders stg_cmis_folder WHERE ((((stg_cmis_document.alfresco_id = ope_cmis_document_parent.alfresco_id) AND ((ope_cmis_document_parent.cmis_objectid)::text = (stg_cmis_document.cmis_objectid)::text)) AND (ope_cmis_document_parent.alfresco_id = stg_cmis_folder.alfresco_id)) AND ((ope_cmis_document_parent.cmis_parentid)::text = (stg_cmis_folder.cmis_objectid)::text)) UNION ALL SELECT stg_cmis_folder.cmis_objectid, stg_cmis_folder.cmis_objecttypeid, upper((stg_cmis_folder.cmis_path)::text) AS cmis_path FROM stg_cmis_folders stg_cmis_folder WHERE (stg_cmis_folder.cmis_path IS NOT NULL);